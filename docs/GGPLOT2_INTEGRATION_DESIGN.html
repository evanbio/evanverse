<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ggplot2 集成设计方案 • evanverse</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" sizes="any" href="favicon.ico"><link rel="manifest" href="site.webmanifest"><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Inter-0.4.10/font.css" rel="stylesheet"><link href="deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="ggplot2 集成设计方案"><meta property="og:image" content="https://evanbio.github.io/evanverse/reference/figures/logo.png"><meta property="og:image:alt" content="evanverse: Comprehensive R utility toolkit for data analysis and bioinformatics"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@evanbio"><meta name="twitter:site" content="@evanbio"><meta name="keywords" content="R package, data analysis, bioinformatics, visualization, utilities, CRAN"><meta name="description" content="evanverse: A comprehensive R utility package with 55+ functions for data analysis, visualization, and bioinformatics workflows"><meta name="author" content="Evan Zhou"><!-- Enhanced Favicon --><link rel="icon" type="image/png" sizes="32x32" href="man/figures/logo.png"><link rel="icon" type="image/png" sizes="16x16" href="man/figures/logo.png"><link rel="apple-touch-icon" sizes="180x180" href="man/figures/logo.png"><!-- Enhanced CSS for professional appearance --><style>
  /* Navigation styling */
  .navbar-brand { font-size: 1.5rem; font-weight: 600; }
  .navbar-brand img { height: 36px; margin-right: 10px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1)); }
  .navbar { box-shadow: 0 2px 12px rgba(0,0,0,0.08); backdrop-filter: blur(10px); }
  .navbar-nav .nav-link { color: #424242 !important; font-weight: 500; font-size: 1.05rem; transition: all 0.3s ease; }
  .navbar-nav .nav-link:hover { color: #0D47A1 !important; transform: translateY(-1px); }
  .navbar-nav .dropdown-item { font-size: 1rem; }

  /* Card and content styling */
  .card {
    box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    border: none;
    border-radius: 0.75rem;
    transition: all 0.3s ease;
  }
  .card:hover { box-shadow: 0 8px 24px rgba(0,0,0,0.12); transform: translateY(-2px); }

  /* Button enhancements */
  .btn-primary {
    background: linear-gradient(135deg, #0D47A1, #1976D2);
    border: none;
    box-shadow: 0 2px 8px rgba(13,71,161,0.3);
    transition: all 0.3s ease;
  }
  .btn-primary:hover {
    background: linear-gradient(135deg, #1976D2, #2196F3);
    box-shadow: 0 4px 16px rgba(13,71,161,0.4);
    transform: translateY(-1px);
  }

  /* Typography improvements */
  h1, h2, h3 { color: #0D47A1; font-weight: 600; }
  h1 { font-size: 2.5rem; margin-bottom: 1.5rem; }
  h2 { font-size: 2rem; margin: 2rem 0 1rem 0; }
  h3 { font-size: 1.5rem; margin: 1.5rem 0 1rem 0; }

  /* Code blocks */
  pre, code { border-radius: 0.5rem; }
  pre { box-shadow: inset 0 2px 8px rgba(0,0,0,0.1); }

  /* Reference page styling */
  .ref-index h2 { border-bottom: 3px solid #E3F2FD; padding-bottom: 0.5rem; }
  .ref-index .icon { color: #0D47A1; margin-right: 0.5rem; }

  /* Footer */
  .footer { background: linear-gradient(135deg, #F8F9FA, #E3F2FD); }

  /* Mobile responsiveness */
  @media (max-width: 768px) {
    .navbar-brand { font-size: 1.25rem; }
    .navbar-brand img { height: 32px; }
    .navbar-nav .nav-link { font-size: 1rem; }
    h1 { font-size: 2rem; }
    .card { margin-bottom: 1rem; }
  }
</style></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">evanverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="articles/install.html">Install</a></li>
<li class="nav-item"><a class="nav-link" href="articles/get-started.html">Get Started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="articles/comprehensive-guide.html">Comprehensive Guide</a></li>
    <li><a class="dropdown-item" href="articles/package-management.html">Package Management</a></li>
    <li><a class="dropdown-item" href="articles/data-processing.html">Data Processing</a></li>
    <li><a class="dropdown-item" href="articles/color-palettes.html">Color Palettes</a></li>
    <li><a class="dropdown-item" href="articles/bioinformatics-workflows.html">Bioinformatics Workflows</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="articles/">All Articles</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/evanbio/evanverse" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://cran.r-project.org/package=evanverse" aria-label="CRAN"><span class="fa fas fa-download"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>ggplot2 集成设计方案</h1>
      <small class="dont-index">Source: <a href="https://github.com/evanbio/evanverse/blob/HEAD/GGPLOT2_INTEGRATION_DESIGN.md" class="external-link"><code>GGPLOT2_INTEGRATION_DESIGN.md</code></a></small>
    </div>

<div id="ggplot2-集成设计方案" class="section level1">

<blockquote>
<p><strong>设计日期</strong>: 2025-10-28 <strong>版本</strong>: v1.0 <strong>状态</strong>: 设计阶段</p>
</blockquote>
<hr><div class="section level2">
<h2 id="目录">目录<a class="anchor" aria-label="anchor" href="#%E7%9B%AE%E5%BD%95"></a></h2>
<ul><li><a href="#%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87">设计目标</a></li>
<li><a href="#%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84">系统架构</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD">核心功能</a></li>
<li><a href="#api-%E8%AE%BE%E8%AE%A1">API 设计</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82">实现细节</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B">使用示例</a></li>
<li><a href="#%E6%B5%8B%E8%AF%95%E8%AE%A1%E5%88%92">测试计划</a></li>
<li><a href="#%E5%8F%91%E5%B8%83%E8%B7%AF%E7%BA%BF%E5%9B%BE">发布路线图</a></li>
</ul><hr></div>
<div class="section level2">
<h2 id="设计目标">设计目标<a class="anchor" aria-label="anchor" href="#%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87"></a></h2>
<div class="section level3">
<h3 id="核心目标">核心目标<a class="anchor" aria-label="anchor" href="#%E6%A0%B8%E5%BF%83%E7%9B%AE%E6%A0%87"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>无缝集成</strong> - 用户无需手动调用 <code><a href="reference/get_palette.html">get_palette()</a></code> + <code>scale_*_manual()</code>
</li>
<li>
<strong>类型自动推断</strong> - 根据palette名称前缀自动识别类型</li>
<li>
<strong>完整功能支持</strong> - 覆盖 color/fill，离散/连续数据</li>
<li>
<strong>向后兼容</strong> - 不破坏现有API和用户代码</li>
</ol></div>
<div class="section level3">
<h3 id="用户体验目标">用户体验目标<a class="anchor" aria-label="anchor" href="#%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C%E7%9B%AE%E6%A0%87"></a></h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ❌ 当前方式（繁琐）</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="st">"qual_vivid"</span>, type <span class="op">=</span> <span class="st">"qualitative"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ✅ 目标方式（简洁）</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/scale_evanverse.html">scale_color_evanverse</a></span><span class="op">(</span><span class="st">"qual_vivid"</span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="系统架构">系统架构<a class="anchor" aria-label="anchor" href="#%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84"></a></h2>
<div class="section level3">
<h3 id="整体架构图">整体架构图<a class="anchor" aria-label="anchor" href="#%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84%E5%9B%BE"></a></h3>
<pre><code>┌─────────────────────────────────────────────────────────┐
│                   evanverse Palette System              │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌──────────────┐      ┌─────────────────────────┐    │
│  │ Core Layer   │      │  ggplot2 Integration    │    │
│  ├──────────────┤      ├─────────────────────────┤    │
│  │ get_palette()│◄─────┤ scale_color_evanverse() │    │
│  │ list_palettes│      │ scale_fill_evanverse()  │    │
│  │ compile_*()  │      │ scale_*_gradient_ev()   │    │
│  └──────────────┘      └─────────────────────────┘    │
│         ▲                         │                     │
│         │                         │                     │
│         │                         ▼                     │
│  ┌──────────────┐      ┌─────────────────────────┐    │
│  │ JSON/RDS     │      │    ggplot2 Themes       │    │
│  │ Storage      │      ├─────────────────────────┤    │
│  └──────────────┘      │ theme_evanverse()       │    │
│                        └─────────────────────────┘    │
└─────────────────────────────────────────────────────────┘
                              ▼
                    ┌──────────────────┐
                    │   User's Plot    │
                    └──────────────────┘</code></pre>
</div>
<div class="section level3">
<h3 id="模块划分">模块划分<a class="anchor" aria-label="anchor" href="#%E6%A8%A1%E5%9D%97%E5%88%92%E5%88%86"></a></h3>
<table class="table"><colgroup><col width="30%"><col width="40%"><col width="30%"></colgroup><thead><tr><th>模块</th>
<th>文件名</th>
<th>职责</th>
</tr></thead><tbody><tr><td><strong>离散色板</strong></td>
<td><code>R/scale_evanverse_discrete.R</code></td>
<td><code>scale_color/fill_evanverse()</code></td>
</tr><tr><td><strong>连续色板</strong></td>
<td><code>R/scale_evanverse_continuous.R</code></td>
<td><code>scale_*_gradient_evanverse()</code></td>
</tr><tr><td><strong>主题系统</strong></td>
<td><code>R/theme_evanverse.R</code></td>
<td><code>theme_evanverse()</code></td>
</tr><tr><td><strong>辅助工具</strong></td>
<td><code>R/palette_ggplot2_utils.R</code></td>
<td>插值、验证、转换工具</td>
</tr></tbody></table><hr></div>
</div>
<div class="section level2">
<h2 id="核心功能">核心功能<a class="anchor" aria-label="anchor" href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD"></a></h2>
<div class="section level3">
<h3 id="id_1-离散色板函数-discrete-scales">1. 离散色板函数 (Discrete Scales)<a class="anchor" aria-label="anchor" href="#id_1-%E7%A6%BB%E6%95%A3%E8%89%B2%E6%9D%BF%E5%87%BD%E6%95%B0-discrete-scales"></a></h3>
<div class="section level4">
<h4 id="功能清单">功能清单<a class="anchor" aria-label="anchor" href="#%E5%8A%9F%E8%83%BD%E6%B8%85%E5%8D%95"></a></h4>
<ul><li>✅ <code><a href="reference/scale_evanverse.html">scale_color_evanverse()</a></code> - 离散型color scale</li>
<li>✅ <code><a href="reference/scale_evanverse.html">scale_fill_evanverse()</a></code> - 离散型fill scale</li>
<li>✅ 自动类型推断 (qual_* → qualitative)</li>
<li>✅ 支持所有 ggplot2 scale 参数</li>
</ul></div>
<div class="section level4">
<h4 id="设计规格">设计规格<a class="anchor" aria-label="anchor" href="#%E8%AE%BE%E8%AE%A1%E8%A7%84%E6%A0%BC"></a></h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>scale_color_evanverse <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  palette,                    <span class="co"># 色板名称，如 "qual_vivid"</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">type =</span> <span class="cn">NULL</span>,                <span class="co"># 可选，类型（自动推断）</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">n =</span> <span class="cn">NULL</span>,                   <span class="co"># 颜色数量（自动匹配分类数）</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">reverse =</span> <span class="cn">FALSE</span>,            <span class="co"># 反转颜色顺序</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">na.value =</span> <span class="st">"grey50"</span>,        <span class="co"># NA值的颜色</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">guide =</span> <span class="st">"legend"</span>,           <span class="co"># 图例类型</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">aesthetics =</span> <span class="st">"colour"</span>,      <span class="co"># 应用的美学映射</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  ...                         <span class="co"># 传递给 scale_color_manual()</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>参数说明</strong>:</p>
<table class="table"><thead><tr><th>参数</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr></thead><tbody><tr><td><code>palette</code></td>
<td><code>character</code></td>
<td>必填</td>
<td>色板名称，支持自动推断类型</td>
</tr><tr><td><code>type</code></td>
<td><code>character</code></td>
<td><code>NULL</code></td>
<td>显式指定类型，为空则从名称推断</td>
</tr><tr><td><code>n</code></td>
<td><code>integer</code></td>
<td><code>NULL</code></td>
<td>需要的颜色数，为空则使用全部</td>
</tr><tr><td><code>reverse</code></td>
<td><code>logical</code></td>
<td><code>FALSE</code></td>
<td>是否反转颜色顺序</td>
</tr><tr><td><code>na.value</code></td>
<td><code>character</code></td>
<td><code>"grey50"</code></td>
<td>NA值的默认颜色</td>
</tr><tr><td><code>guide</code></td>
<td><code>character</code></td>
<td><code>"legend"</code></td>
<td>图例类型</td>
</tr><tr><td><code>aesthetics</code></td>
<td><code>character</code></td>
<td><code>"colour"</code></td>
<td>应用的美学映射</td>
</tr></tbody></table><hr></div>
</div>
<div class="section level3">
<h3 id="id_2-连续色板函数-continuous-scales">2. 连续色板函数 (Continuous Scales)<a class="anchor" aria-label="anchor" href="#id_2-%E8%BF%9E%E7%BB%AD%E8%89%B2%E6%9D%BF%E5%87%BD%E6%95%B0-continuous-scales"></a></h3>
<div class="section level4">
<h4 id="功能清单-1">功能清单<a class="anchor" aria-label="anchor" href="#%E5%8A%9F%E8%83%BD%E6%B8%85%E5%8D%95-1"></a></h4>
<ul><li>✅ <code>scale_color_gradient_evanverse()</code> - 连续型color gradient</li>
<li>✅ <code>scale_fill_gradient_evanverse()</code> - 连续型fill gradient</li>
<li>✅ <code>scale_*_gradient2_evanverse()</code> - 双向渐变（diverging）</li>
<li>✅ <code>scale_*_gradientn_evanverse()</code> - 多色渐变</li>
</ul></div>
<div class="section level4">
<h4 id="设计规格-1">设计规格<a class="anchor" aria-label="anchor" href="#%E8%AE%BE%E8%AE%A1%E8%A7%84%E6%A0%BC-1"></a></h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>scale_color_gradient_evanverse <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  palette,                    <span class="co"># 色板名称</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">type =</span> <span class="cn">NULL</span>,                <span class="co"># 色板类型</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">low =</span> <span class="cn">NULL</span>,                 <span class="co"># 低值颜色（可选，从色板取）</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">high =</span> <span class="cn">NULL</span>,                <span class="co"># 高值颜色（可选，从色板取）</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">space =</span> <span class="st">"Lab"</span>,              <span class="co"># 颜色空间</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="at">na.value =</span> <span class="st">"grey50"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="at">guide =</span> <span class="st">"colorbar"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="at">aesthetics =</span> <span class="st">"colour"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  ...</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>scale_color_gradient2_evanverse <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  palette,                    <span class="co"># Diverging色板名称</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"diverging"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="at">low =</span> <span class="cn">NULL</span>,                 <span class="co"># 从色板取第一个颜色</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>  <span class="at">mid =</span> <span class="cn">NULL</span>,                 <span class="co"># 从色板取中间颜色</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>  <span class="at">high =</span> <span class="cn">NULL</span>,                <span class="co"># 从色板取最后颜色</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>  <span class="at">midpoint =</span> <span class="dv">0</span>,               <span class="co"># 中心点值</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>  <span class="at">na.value =</span> <span class="st">"grey50"</span>,</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>  <span class="at">guide =</span> <span class="st">"colorbar"</span>,</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>  <span class="at">aesthetics =</span> <span class="st">"colour"</span>,</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>  ...</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>)</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>scale_color_gradientn_evanverse <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>  palette,                    <span class="co"># 任意色板名称</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>  <span class="at">type =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>  <span class="at">n =</span> <span class="cn">NULL</span>,                   <span class="co"># 插值点数量</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>  <span class="at">colours =</span> <span class="cn">NULL</span>,             <span class="co"># 从色板自动获取</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>  <span class="at">values =</span> <span class="cn">NULL</span>,              <span class="co"># 颜色位置（0-1）</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a>  <span class="at">space =</span> <span class="st">"Lab"</span>,</span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a>  <span class="at">na.value =</span> <span class="st">"grey50"</span>,</span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>  <span class="at">guide =</span> <span class="st">"colorbar"</span>,</span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>  <span class="at">aesthetics =</span> <span class="st">"colour"</span>,</span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a>  ...</span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>)</span></code></pre></div>
<hr></div>
</div>
<div class="section level3">
<h3 id="id_3-主题系统">3. 主题系统<a class="anchor" aria-label="anchor" href="#id_3-%E4%B8%BB%E9%A2%98%E7%B3%BB%E7%BB%9F"></a></h3>
<div class="section level4">
<h4 id="功能清单-2">功能清单<a class="anchor" aria-label="anchor" href="#%E5%8A%9F%E8%83%BD%E6%B8%85%E5%8D%95-2"></a></h4>
<ul><li>✅ <code>theme_evanverse()</code> - 基础主题</li>
<li>✅ 预设主题变体 (light/dark/minimal/classic)</li>
<li>✅ 与色板自动配套</li>
</ul></div>
<div class="section level4">
<h4 id="设计规格-2">设计规格<a class="anchor" aria-label="anchor" href="#%E8%AE%BE%E8%AE%A1%E8%A7%84%E6%A0%BC-2"></a></h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>theme_evanverse <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="at">base_size =</span> <span class="dv">11</span>,             <span class="co"># 基础字体大小</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">base_family =</span> <span class="st">""</span>,           <span class="co"># 字体族</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">base_line_size =</span> <span class="fl">0.5</span>,       <span class="co"># 线条粗细</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">base_rect_size =</span> <span class="fl">0.5</span>,       <span class="co"># 矩形边框粗细</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">variant =</span> <span class="st">"light"</span>,          <span class="co"># 主题变体</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">palette =</span> <span class="cn">NULL</span>,             <span class="co"># 可选：搭配色板</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  ...</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>主题变体</strong>:</p>
<table class="table"><thead><tr><th>变体</th>
<th>描述</th>
<th>适用场景</th>
</tr></thead><tbody><tr><td><code>light</code></td>
<td>浅色背景，深色文字</td>
<td>论文、演示文稿</td>
</tr><tr><td><code>dark</code></td>
<td>深色背景，浅色文字</td>
<td>数据仪表板</td>
</tr><tr><td><code>minimal</code></td>
<td>极简风格，少网格线</td>
<td>杂志插图</td>
</tr><tr><td><code>classic</code></td>
<td>传统学术风格</td>
<td>期刊发表</td>
</tr></tbody></table><hr></div>
</div>
<div class="section level3">
<h3 id="id_4-辅助工具函数">4. 辅助工具函数<a class="anchor" aria-label="anchor" href="#id_4-%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0"></a></h3>
<div class="section level4">
<h4 id="色板插值">色板插值<a class="anchor" aria-label="anchor" href="#%E8%89%B2%E6%9D%BF%E6%8F%92%E5%80%BC"></a></h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>interpolate_palette <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  palette,                    <span class="co"># 色板名称</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">type =</span> <span class="cn">NULL</span>,                <span class="co"># 色板类型</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  n,                          <span class="co"># 目标颜色数</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"linear"</span>           <span class="co"># 插值方法："linear", "spline"</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>用途</strong>: 从5色色板生成20色渐变</p>
<hr></div>
<div class="section level4">
<h4 id="色板预览ggplot2版">色板预览（ggplot2版）<a class="anchor" aria-label="anchor" href="#%E8%89%B2%E6%9D%BF%E9%A2%84%E8%A7%88ggplot2%E7%89%88"></a></h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>preview_palette_ggplot <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  palette,                    <span class="co"># 色板名称</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">type =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">plot_type =</span> <span class="st">"bar"</span>           <span class="co"># "bar", "point", "tile"</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>输出</strong>: 返回ggplot对象，可进一步自定义</p>
<hr></div>
<div class="section level4">
<h4 id="快速应用">快速应用<a class="anchor" aria-label="anchor" href="#%E5%BF%AB%E9%80%9F%E5%BA%94%E7%94%A8"></a></h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>apply_evanverse_colors <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  plot,                       <span class="co"># ggplot对象</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  palette,                    <span class="co"># 色板名称</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">color_aes =</span> <span class="st">"color"</span>,        <span class="co"># "color", "fill", "both"</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">add_theme =</span> <span class="cn">TRUE</span>            <span class="co"># 是否同时应用theme</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>用途</strong>: 一键将色板应用到现有图表</p>
<hr></div>
</div>
</div>
<div class="section level2">
<h2 id="api-设计">API 设计<a class="anchor" aria-label="anchor" href="#api-%E8%AE%BE%E8%AE%A1"></a></h2>
<div class="section level3">
<h3 id="设计原则">设计原则<a class="anchor" aria-label="anchor" href="#%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>一致性</strong> - 函数命名遵循 <code>scale_*_evanverse</code> 模式</li>
<li>
<strong>灵活性</strong> - 所有ggplot2原生参数都可传递</li>
<li>
<strong>智能化</strong> - 自动推断类型，自动匹配颜色数</li>
<li>
<strong>可组合</strong> - 可与其他ggplot2元素自由组合</li>
</ol></div>
<div class="section level3">
<h3 id="命名规范">命名规范<a class="anchor" aria-label="anchor" href="#%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83"></a></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># 离散型</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>scale_<span class="sc">&lt;</span>aesthetic<span class="sc">&gt;</span><span class="fu">_evanverse</span>(palette, ...)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># 连续型</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>scale_<span class="sc">&lt;</span>aesthetic<span class="sc">&gt;</span><span class="fu">_gradient_evanverse</span>(palette, ...)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>scale_<span class="sc">&lt;</span>aesthetic<span class="sc">&gt;</span><span class="fu">_gradient2_evanverse</span>(palette, ...)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>scale_<span class="sc">&lt;</span>aesthetic<span class="sc">&gt;</span><span class="fu">_gradientn_evanverse</span>(palette, ...)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co"># 主题</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="fu">theme_evanverse</span>(<span class="at">variant =</span> <span class="st">"light"</span>, ...)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co"># 辅助</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="fu">interpolate_palette</span>(palette, n)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="fu">preview_palette_ggplot</span>(palette)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="fu">apply_evanverse_colors</span>(plot, palette)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="类型自动推断逻辑">类型自动推断逻辑<a class="anchor" aria-label="anchor" href="#%E7%B1%BB%E5%9E%8B%E8%87%AA%E5%8A%A8%E6%8E%A8%E6%96%AD%E9%80%BB%E8%BE%91"></a></h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infer_palette_type</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">palette</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">prefix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(seq|div|qual)_.*"</span>, <span class="st">"\\1"</span>, <span class="va">palette</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">type_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"seq"</span> <span class="op">=</span> <span class="st">"sequential"</span>,</span>
<span>    <span class="st">"div"</span> <span class="op">=</span> <span class="st">"diverging"</span>,</span>
<span>    <span class="st">"qual"</span> <span class="op">=</span> <span class="st">"qualitative"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">prefix</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">type_map</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">type_map</span><span class="op">[</span><span class="va">prefix</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="st">"Cannot infer palette type from name '{palette}'"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="实现细节">实现细节<a class="anchor" aria-label="anchor" href="#%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82"></a></h2>
<div class="section level3">
<h3 id="实现步骤">实现步骤<a class="anchor" aria-label="anchor" href="#%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"></a></h3>
<div class="section level4">
<h4 id="phase-1-基础离散色板-week-1">Phase 1: 基础离散色板 (Week 1)<a class="anchor" aria-label="anchor" href="#phase-1-%E5%9F%BA%E7%A1%80%E7%A6%BB%E6%95%A3%E8%89%B2%E6%9D%BF-week-1"></a></h4>
<p><strong>文件</strong>: <code>R/scale_evanverse_discrete.R</code></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Color Scale for evanverse Palettes (Discrete)</span></span>
<span><span class="co">#' @description Apply evanverse color palettes to ggplot2 discrete scales</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param palette Name of palette (e.g., "qual_vivid", "seq_blues")</span></span>
<span><span class="co">#' @param type Palette type. If NULL, automatically inferred from name</span></span>
<span><span class="co">#' @param n Number of colors. If NULL, uses all available colors</span></span>
<span><span class="co">#' @param reverse Logical. Reverse color order?</span></span>
<span><span class="co">#' @param na.value Color for NA values</span></span>
<span><span class="co">#' @param guide Type of legend</span></span>
<span><span class="co">#' @param aesthetics Character vector of aesthetics to apply</span></span>
<span><span class="co">#' @param ... Additional parameters passed to \code{scale_color_manual}</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return A ggplot2 scale object</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' library(ggplot2)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Basic usage</span></span>
<span><span class="co">#' ggplot(iris, aes(Sepal.Length, Sepal.Width, color = Species)) +</span></span>
<span><span class="co">#'   geom_point(size = 3) +</span></span>
<span><span class="co">#'   scale_color_evanverse("qual_vivid")</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Reverse colors</span></span>
<span><span class="co">#' ggplot(iris, aes(Sepal.Length, Sepal.Width, color = Species)) +</span></span>
<span><span class="co">#'   geom_point(size = 3) +</span></span>
<span><span class="co">#'   scale_color_evanverse("qual_vivid", reverse = TRUE)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Explicit type</span></span>
<span><span class="co">#' ggplot(iris, aes(Sepal.Length, Sepal.Width, fill = Species)) +</span></span>
<span><span class="co">#'   geom_boxplot() +</span></span>
<span><span class="co">#'   scale_fill_evanverse("qual_vivid", type = "qualitative")</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">scale_color_evanverse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">type</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">n</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">reverse</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">na.value</span> <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  <span class="va">guide</span> <span class="op">=</span> <span class="st">"legend"</span>,</span>
<span>  <span class="va">aesthetics</span> <span class="op">=</span> <span class="st">"colour"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># 1. Type inference</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">type</span> <span class="op">&lt;-</span> <span class="fu">infer_palette_type</span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># 2. Get palette colors</span></span>
<span>  <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># 3. Subset if n specified</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_warn</a></span><span class="op">(</span><span class="st">"Requested {n} colors but palette '{palette}' only has {length(colors)}. Using interpolation."</span><span class="op">)</span></span>
<span>      <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu">interpolate_palette</span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">colors</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># 4. Reverse if needed</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">reverse</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># 5. Apply scale</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="va">colors</span>,</span>
<span>    na.value <span class="op">=</span> <span class="va">na.value</span>,</span>
<span>    guide <span class="op">=</span> <span class="va">guide</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="va">aesthetics</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @rdname scale_color_evanverse</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">scale_fill_evanverse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">type</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">n</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">reverse</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">na.value</span> <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  <span class="va">guide</span> <span class="op">=</span> <span class="st">"legend"</span>,</span>
<span>  <span class="va">aesthetics</span> <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># 复用逻辑，只改变 aesthetics</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">type</span> <span class="op">&lt;-</span> <span class="fu">infer_palette_type</span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu">interpolate_palette</span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">colors</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">reverse</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="va">colors</span>,</span>
<span>    na.value <span class="op">=</span> <span class="va">na.value</span>,</span>
<span>    guide <span class="op">=</span> <span class="va">guide</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="va">aesthetics</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @title Colour Scale for evanverse Palettes (British Spelling)</span></span>
<span><span class="co">#' @rdname scale_color_evanverse</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">scale_colour_evanverse</span> <span class="op">&lt;-</span> <span class="va">scale_color_evanverse</span></span></code></pre></div>
<p><strong>依赖关系</strong>: - 依赖: <code><a href="reference/get_palette.html">get_palette()</a></code>, <code>infer_palette_type()</code> - 新增: <code>interpolate_palette()</code></p>
<hr></div>
<div class="section level4">
<h4 id="phase-2-连续色板支持-week-2">Phase 2: 连续色板支持 (Week 2)<a class="anchor" aria-label="anchor" href="#phase-2-%E8%BF%9E%E7%BB%AD%E8%89%B2%E6%9D%BF%E6%94%AF%E6%8C%81-week-2"></a></h4>
<p><strong>文件</strong>: <code>R/scale_evanverse_continuous.R</code></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Gradient Color Scale for evanverse Palettes</span></span>
<span><span class="co">#' @description Apply evanverse color palettes to ggplot2 continuous scales</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param palette Name of palette</span></span>
<span><span class="co">#' @param type Palette type (automatically inferred if NULL)</span></span>
<span><span class="co">#' @param low Color for low values (from palette if NULL)</span></span>
<span><span class="co">#' @param high Color for high values (from palette if NULL)</span></span>
<span><span class="co">#' @param space Color interpolation space</span></span>
<span><span class="co">#' @param na.value Color for NA values</span></span>
<span><span class="co">#' @param guide Type of legend</span></span>
<span><span class="co">#' @param aesthetics Aesthetics to apply</span></span>
<span><span class="co">#' @param ... Additional parameters</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' library(ggplot2)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Heatmap with sequential palette</span></span>
<span><span class="co">#' df &lt;- expand.grid(x = 1:10, y = 1:10)</span></span>
<span><span class="co">#' df$value &lt;- df$x * df$y</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' ggplot(df, aes(x, y, fill = value)) +</span></span>
<span><span class="co">#'   geom_tile() +</span></span>
<span><span class="co">#'   scale_fill_gradient_evanverse("seq_blues")</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Diverging gradient for fold changes</span></span>
<span><span class="co">#' ggplot(data, aes(x, y, color = log2fc)) +</span></span>
<span><span class="co">#'   geom_point() +</span></span>
<span><span class="co">#'   scale_color_gradient2_evanverse("div_fireice", midpoint = 0)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">scale_color_gradient_evanverse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">type</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">low</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">high</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">space</span> <span class="op">=</span> <span class="st">"Lab"</span>,</span>
<span>  <span class="va">na.value</span> <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  <span class="va">guide</span> <span class="op">=</span> <span class="st">"colorbar"</span>,</span>
<span>  <span class="va">aesthetics</span> <span class="op">=</span> <span class="st">"colour"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">type</span> <span class="op">&lt;-</span> <span class="fu">infer_palette_type</span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Use first and last colors</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">low</span><span class="op">)</span><span class="op">)</span> <span class="va">low</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">high</span><span class="op">)</span><span class="op">)</span> <span class="va">high</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span></span>
<span>    low <span class="op">=</span> <span class="va">low</span>,</span>
<span>    high <span class="op">=</span> <span class="va">high</span>,</span>
<span>    space <span class="op">=</span> <span class="va">space</span>,</span>
<span>    na.value <span class="op">=</span> <span class="va">na.value</span>,</span>
<span>    guide <span class="op">=</span> <span class="va">guide</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="va">aesthetics</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @rdname scale_color_gradient_evanverse</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">scale_fill_gradient_evanverse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">type</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">low</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">high</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">space</span> <span class="op">=</span> <span class="st">"Lab"</span>,</span>
<span>  <span class="va">na.value</span> <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  <span class="va">guide</span> <span class="op">=</span> <span class="st">"colorbar"</span>,</span>
<span>  <span class="va">aesthetics</span> <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">type</span> <span class="op">&lt;-</span> <span class="fu">infer_palette_type</span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">low</span><span class="op">)</span><span class="op">)</span> <span class="va">low</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">high</span><span class="op">)</span><span class="op">)</span> <span class="va">high</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span></span>
<span>    low <span class="op">=</span> <span class="va">low</span>,</span>
<span>    high <span class="op">=</span> <span class="va">high</span>,</span>
<span>    space <span class="op">=</span> <span class="va">space</span>,</span>
<span>    na.value <span class="op">=</span> <span class="va">na.value</span>,</span>
<span>    guide <span class="op">=</span> <span class="va">guide</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="va">aesthetics</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @rdname scale_color_gradient_evanverse</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">scale_color_gradient2_evanverse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">type</span> <span class="op">=</span> <span class="st">"diverging"</span>,</span>
<span>  <span class="va">low</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">mid</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">high</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">midpoint</span> <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">space</span> <span class="op">=</span> <span class="st">"Lab"</span>,</span>
<span>  <span class="va">na.value</span> <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  <span class="va">guide</span> <span class="op">=</span> <span class="st">"colorbar"</span>,</span>
<span>  <span class="va">aesthetics</span> <span class="op">=</span> <span class="st">"colour"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">low</span><span class="op">)</span><span class="op">)</span> <span class="va">low</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">mid</span><span class="op">)</span><span class="op">)</span> <span class="va">mid</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">high</span><span class="op">)</span><span class="op">)</span> <span class="va">high</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="va">n</span><span class="op">]</span></span>
<span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient2</a></span><span class="op">(</span></span>
<span>    low <span class="op">=</span> <span class="va">low</span>,</span>
<span>    mid <span class="op">=</span> <span class="va">mid</span>,</span>
<span>    high <span class="op">=</span> <span class="va">high</span>,</span>
<span>    midpoint <span class="op">=</span> <span class="va">midpoint</span>,</span>
<span>    space <span class="op">=</span> <span class="va">space</span>,</span>
<span>    na.value <span class="op">=</span> <span class="va">na.value</span>,</span>
<span>    guide <span class="op">=</span> <span class="va">guide</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="va">aesthetics</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @rdname scale_color_gradient_evanverse</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">scale_fill_gradient2_evanverse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">type</span> <span class="op">=</span> <span class="st">"diverging"</span>,</span>
<span>  <span class="va">low</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">mid</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">high</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">midpoint</span> <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">space</span> <span class="op">=</span> <span class="st">"Lab"</span>,</span>
<span>  <span class="va">na.value</span> <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  <span class="va">guide</span> <span class="op">=</span> <span class="st">"colorbar"</span>,</span>
<span>  <span class="va">aesthetics</span> <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">low</span><span class="op">)</span><span class="op">)</span> <span class="va">low</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">mid</span><span class="op">)</span><span class="op">)</span> <span class="va">mid</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">high</span><span class="op">)</span><span class="op">)</span> <span class="va">high</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="va">n</span><span class="op">]</span></span>
<span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span></span>
<span>    low <span class="op">=</span> <span class="va">low</span>,</span>
<span>    mid <span class="op">=</span> <span class="va">mid</span>,</span>
<span>    high <span class="op">=</span> <span class="va">high</span>,</span>
<span>    midpoint <span class="op">=</span> <span class="va">midpoint</span>,</span>
<span>    space <span class="op">=</span> <span class="va">space</span>,</span>
<span>    na.value <span class="op">=</span> <span class="va">na.value</span>,</span>
<span>    guide <span class="op">=</span> <span class="va">guide</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="va">aesthetics</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @rdname scale_color_gradient_evanverse</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">scale_color_gradientn_evanverse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">type</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">colours</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">values</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">space</span> <span class="op">=</span> <span class="st">"Lab"</span>,</span>
<span>  <span class="va">na.value</span> <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  <span class="va">guide</span> <span class="op">=</span> <span class="st">"colorbar"</span>,</span>
<span>  <span class="va">aesthetics</span> <span class="op">=</span> <span class="st">"colour"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">type</span> <span class="op">&lt;-</span> <span class="fu">infer_palette_type</span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">colours</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradientn</a></span><span class="op">(</span></span>
<span>    colours <span class="op">=</span> <span class="va">colours</span>,</span>
<span>    values <span class="op">=</span> <span class="va">values</span>,</span>
<span>    space <span class="op">=</span> <span class="va">space</span>,</span>
<span>    na.value <span class="op">=</span> <span class="va">na.value</span>,</span>
<span>    guide <span class="op">=</span> <span class="va">guide</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="va">aesthetics</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @rdname scale_color_gradient_evanverse</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">scale_fill_gradientn_evanverse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">type</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">colours</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">values</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">space</span> <span class="op">=</span> <span class="st">"Lab"</span>,</span>
<span>  <span class="va">na.value</span> <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  <span class="va">guide</span> <span class="op">=</span> <span class="st">"colorbar"</span>,</span>
<span>  <span class="va">aesthetics</span> <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">type</span> <span class="op">&lt;-</span> <span class="fu">infer_palette_type</span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">colours</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span></span>
<span>    colours <span class="op">=</span> <span class="va">colours</span>,</span>
<span>    values <span class="op">=</span> <span class="va">values</span>,</span>
<span>    space <span class="op">=</span> <span class="va">space</span>,</span>
<span>    na.value <span class="op">=</span> <span class="va">na.value</span>,</span>
<span>    guide <span class="op">=</span> <span class="va">guide</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="va">aesthetics</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr></div>
<div class="section level4">
<h4 id="phase-3-辅助工具-week-2">Phase 3: 辅助工具 (Week 2)<a class="anchor" aria-label="anchor" href="#phase-3-%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7-week-2"></a></h4>
<p><strong>文件</strong>: <code>R/palette_ggplot2_utils.R</code></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Interpolate Palette Colors</span></span>
<span><span class="co">#' @description Generate n colors from a palette using interpolation</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param palette Name of palette</span></span>
<span><span class="co">#' @param type Palette type</span></span>
<span><span class="co">#' @param n Number of colors to generate</span></span>
<span><span class="co">#' @param method Interpolation method: "linear" or "spline"</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return Character vector of hex colors</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' # Generate 20 colors from a 5-color palette</span></span>
<span><span class="co">#' interpolate_palette("seq_blues", type = "sequential", n = 20)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">interpolate_palette</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">type</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">method</span> <span class="op">=</span> <span class="st">"linear"</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Validate inputs</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html" class="external-link">missing</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">||</span> <span class="va">n</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="st">"'n' must be an integer &gt;= 2"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">type</span> <span class="op">&lt;-</span> <span class="fu">infer_palette_type</span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Get base colors</span></span>
<span>  <span class="va">base_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Interpolate</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"linear"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">color_fun</span> <span class="op">&lt;-</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="va">base_colors</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"spline"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">color_fun</span> <span class="op">&lt;-</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="va">base_colors</span>, space <span class="op">=</span> <span class="st">"Lab"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="st">"method must be 'linear' or 'spline'"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">color_fun</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @title Infer Palette Type from Name</span></span>
<span><span class="co">#' @description Automatically detect palette type from naming convention</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param palette Palette name</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return Character: "sequential", "diverging", or "qualitative"</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' infer_palette_type("seq_blues")     # "sequential"</span></span>
<span><span class="co">#' infer_palette_type("div_fireice")   # "diverging"</span></span>
<span><span class="co">#' infer_palette_type("qual_vivid")    # "qualitative"</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">infer_palette_type</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">palette</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">palette</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">palette</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="st">"'palette' must be a single character string"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Extract prefix</span></span>
<span>  <span class="va">prefix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"^(seq|div|qual)_.*"</span>, <span class="st">"\\1"</span>, <span class="va">palette</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">type_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"seq"</span> <span class="op">=</span> <span class="st">"sequential"</span>,</span>
<span>    <span class="st">"div"</span> <span class="op">=</span> <span class="st">"diverging"</span>,</span>
<span>    <span class="st">"qual"</span> <span class="op">=</span> <span class="st">"qualitative"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">prefix</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">type_map</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">type_map</span><span class="op">[</span><span class="va">prefix</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span></span>
<span>      <span class="st">"Cannot infer type from palette name '{palette}'.</span></span>
<span><span class="st">      Palette names should start with 'seq_', 'div_', or 'qual_'."</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @title Preview Palette with ggplot2</span></span>
<span><span class="co">#' @description Generate a ggplot2 preview of a palette</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param palette Palette name</span></span>
<span><span class="co">#' @param type Palette type</span></span>
<span><span class="co">#' @param plot_type Type of plot: "bar", "point", "tile"</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return A ggplot object</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' library(ggplot2)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Bar plot preview</span></span>
<span><span class="co">#' preview_palette_ggplot("qual_vivid", plot_type = "bar")</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Point plot preview</span></span>
<span><span class="co">#' preview_palette_ggplot("seq_blues", plot_type = "point")</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">preview_palette_ggplot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">type</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">plot_type</span> <span class="op">=</span> <span class="st">"bar"</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">type</span> <span class="op">&lt;-</span> <span class="fu">infer_palette_type</span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="va">palette</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    label <span class="op">=</span> <span class="va">colors</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">plot_type</span> <span class="op">==</span> <span class="st">"bar"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>                        vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colors</span><span class="op">)</span></span>
<span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">plot_type</span> <span class="op">==</span> <span class="st">"point"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>                        vjust <span class="op">=</span> <span class="fl">2</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colors</span><span class="op">)</span></span>
<span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">plot_type</span> <span class="op">==</span> <span class="st">"tile"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">color</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>                        size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colors</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Palette: "</span>, <span class="va">palette</span>, <span class="st">" ("</span>, <span class="va">type</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>      subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">n</span>, <span class="st">"colors"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>      axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr></div>
<div class="section level4">
<h4 id="phase-4-主题系统-week-3">Phase 4: 主题系统 (Week 3)<a class="anchor" aria-label="anchor" href="#phase-4-%E4%B8%BB%E9%A2%98%E7%B3%BB%E7%BB%9F-week-3"></a></h4>
<p><strong>文件</strong>: <code>R/theme_evanverse.R</code></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title evanverse ggplot2 Theme</span></span>
<span><span class="co">#' @description A clean, publication-ready theme for ggplot2</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param base_size Base font size</span></span>
<span><span class="co">#' @param base_family Base font family</span></span>
<span><span class="co">#' @param base_line_size Base line size</span></span>
<span><span class="co">#' @param base_rect_size Base rectangle size</span></span>
<span><span class="co">#' @param variant Theme variant: "light", "dark", "minimal", "classic"</span></span>
<span><span class="co">#' @param palette Optional palette to coordinate colors</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return A ggplot2 theme object</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' library(ggplot2)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Light theme (default)</span></span>
<span><span class="co">#' ggplot(iris, aes(Sepal.Length, Sepal.Width)) +</span></span>
<span><span class="co">#'   geom_point() +</span></span>
<span><span class="co">#'   theme_evanverse()</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Dark theme</span></span>
<span><span class="co">#' ggplot(iris, aes(Sepal.Length, Sepal.Width)) +</span></span>
<span><span class="co">#'   geom_point() +</span></span>
<span><span class="co">#'   theme_evanverse(variant = "dark")</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Minimal theme</span></span>
<span><span class="co">#' ggplot(iris, aes(Sepal.Length, Sepal.Width)) +</span></span>
<span><span class="co">#'   geom_point() +</span></span>
<span><span class="co">#'   theme_evanverse(variant = "minimal")</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">theme_evanverse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">base_size</span> <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  <span class="va">base_family</span> <span class="op">=</span> <span class="st">""</span>,</span>
<span>  <span class="va">base_line_size</span> <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="va">base_rect_size</span> <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="va">variant</span> <span class="op">=</span> <span class="st">"light"</span>,</span>
<span>  <span class="va">palette</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Base theme (starts from theme_minimal)</span></span>
<span>  <span class="va">theme</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span></span>
<span>    base_size <span class="op">=</span> <span class="va">base_size</span>,</span>
<span>    base_family <span class="op">=</span> <span class="va">base_family</span>,</span>
<span>    base_line_size <span class="op">=</span> <span class="va">base_line_size</span>,</span>
<span>    base_rect_size <span class="op">=</span> <span class="va">base_rect_size</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Apply variant-specific modifications</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">variant</span> <span class="op">==</span> <span class="st">"light"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">theme</span> <span class="op">&lt;-</span> <span class="va">theme</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      plot.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey90"</span><span class="op">)</span>,</span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey95"</span><span class="op">)</span>,</span>
<span>      text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey20"</span><span class="op">)</span>,</span>
<span>      axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">variant</span> <span class="op">==</span> <span class="st">"dark"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">theme</span> <span class="op">&lt;-</span> <span class="va">theme</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      plot.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey10"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey10"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey30"</span><span class="op">)</span>,</span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey20"</span><span class="op">)</span>,</span>
<span>      text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey90"</span><span class="op">)</span>,</span>
<span>      axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">variant</span> <span class="op">==</span> <span class="st">"minimal"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">theme</span> <span class="op">&lt;-</span> <span class="va">theme</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.border <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.ticks <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">variant</span> <span class="op">==</span> <span class="st">"classic"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">theme</span> <span class="op">&lt;-</span> <span class="va">theme</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>      panel.grid <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      axis.line <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>      axis.ticks <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Add common enhancements</span></span>
<span>  <span class="va">theme</span> <span class="op">&lt;-</span> <span class="va">theme</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="va">base_size</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="va">base_size</span> <span class="op">*</span> <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    legend.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">theme</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' @title Quick Apply evanverse Theme and Colors</span></span>
<span><span class="co">#' @description Convenience function to apply both theme and color palette</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param plot ggplot object</span></span>
<span><span class="co">#' @param palette Palette name</span></span>
<span><span class="co">#' @param color_aes Aesthetic to apply: "color", "fill", or "both"</span></span>
<span><span class="co">#' @param theme_variant Theme variant</span></span>
<span><span class="co">#' @param ... Additional theme parameters</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return Modified ggplot object</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' library(ggplot2)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' p &lt;- ggplot(iris, aes(Sepal.Length, Sepal.Width, color = Species)) +</span></span>
<span><span class="co">#'   geom_point(size = 3)</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' # Apply both theme and colors</span></span>
<span><span class="co">#' apply_evanverse_theme(p, "qual_vivid")</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">apply_evanverse_theme</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">plot</span>,</span>
<span>  <span class="va">palette</span>,</span>
<span>  <span class="va">color_aes</span> <span class="op">=</span> <span class="st">"color"</span>,</span>
<span>  <span class="va">theme_variant</span> <span class="op">=</span> <span class="st">"light"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Apply theme</span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">plot</span> <span class="op">+</span> <span class="fu">theme_evanverse</span><span class="op">(</span>variant <span class="op">=</span> <span class="va">theme_variant</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Apply colors</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">color_aes</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"color"</span>, <span class="st">"both"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">plot</span> <span class="op">+</span> <span class="fu"><a href="reference/scale_evanverse.html">scale_color_evanverse</a></span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">color_aes</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fill"</span>, <span class="st">"both"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">plot</span> <span class="op">+</span> <span class="fu"><a href="reference/scale_evanverse.html">scale_fill_evanverse</a></span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr></div>
</div>
</div>
<div class="section level2">
<h2 id="使用示例">使用示例<a class="anchor" aria-label="anchor" href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"></a></h2>
<div class="section level3">
<h3 id="示例1-散点图-离散color">示例1: 散点图 (离散color)<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B1-%E6%95%A3%E7%82%B9%E5%9B%BE-%E7%A6%BB%E6%95%A3color"></a></h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/evanbio/evanverse" class="external-link">evanverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 基础用法</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/scale_evanverse.html">scale_color_evanverse</a></span><span class="op">(</span><span class="st">"qual_vivid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Iris Dataset"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Using qual_vivid palette"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="示例2-箱线图-离散fill">示例2: 箱线图 (离散fill)<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B2-%E7%AE%B1%E7%BA%BF%E5%9B%BE-%E7%A6%BB%E6%95%A3fill"></a></h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/scale_evanverse.html">scale_fill_evanverse</a></span><span class="op">(</span><span class="st">"qual_pastel"</span>, reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"minimal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Sepal Length by Species"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="示例3-热图-连续fill">示例3: 热图 (连续fill)<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B3-%E7%83%AD%E5%9B%BE-%E8%BF%9E%E7%BB%ADfill"></a></h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 生成数据</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">y</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_gradient2_evanverse</span><span class="op">(</span><span class="st">"div_fireice"</span>, midpoint <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"dark"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Heatmap with Diverging Palette"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="示例4-密度图-渐变fill">示例4: 密度图 (渐变fill)<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B4-%E5%AF%86%E5%BA%A6%E5%9B%BE-%E6%B8%90%E5%8F%98fill"></a></h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">carat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_gradientn_evanverse</span><span class="op">(</span><span class="st">"seq_blues"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Diamond Carat Distribution"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Carat"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="示例5-多面板组合">示例5: 多面板组合<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B5-%E5%A4%9A%E9%9D%A2%E6%9D%BF%E7%BB%84%E5%90%88"></a></h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/scale_evanverse.html">scale_color_evanverse</a></span><span class="op">(</span><span class="st">"qual_vivid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"light"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Species</span>, <span class="va">Sepal.Width</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/scale_evanverse.html">scale_fill_evanverse</a></span><span class="op">(</span><span class="st">"qual_vivid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"light"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Petal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_gradient_evanverse</span><span class="op">(</span><span class="st">"seq_forest"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"minimal"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 组合</span></span>
<span><span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="va">p3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="示例6-快速应用">示例6: 快速应用<a class="anchor" aria-label="anchor" href="#%E7%A4%BA%E4%BE%8B6-%E5%BF%AB%E9%80%9F%E5%BA%94%E7%94%A8"></a></h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 创建基础图</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 一键应用主题和颜色</span></span>
<span><span class="fu">apply_evanverse_theme</span><span class="op">(</span><span class="va">p</span>, <span class="st">"qual_vibrant"</span>, theme_variant <span class="op">=</span> <span class="st">"classic"</span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="测试计划">测试计划<a class="anchor" aria-label="anchor" href="#%E6%B5%8B%E8%AF%95%E8%AE%A1%E5%88%92"></a></h2>
<div class="section level3">
<h3 id="单元测试">单元测试<a class="anchor" aria-label="anchor" href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"></a></h3>
<p><strong>文件</strong>: <code>tests/testthat/test-scale_evanverse.R</code></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"scale_color_evanverse works with qualitative palettes"</span>, <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="reference/scale_evanverse.html">scale_color_evanverse</a></span><span class="op">(</span><span class="st">"qual_vivid"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_s3_class</span><span class="op">(</span><span class="va">p</span>, <span class="st">"ggplot"</span><span class="op">)</span></span>
<span>  <span class="fu">expect_s3_class</span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">scales</span><span class="op">$</span><span class="va">scales</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"ScaleManual"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"scale_fill_evanverse works with sequential palettes"</span>, <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">y</span></span>
<span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_gradient_evanverse</span><span class="op">(</span><span class="st">"seq_blues"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_s3_class</span><span class="op">(</span><span class="va">p</span>, <span class="st">"ggplot"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"type inference works correctly"</span>, <span class="op">{</span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="fu">infer_palette_type</span><span class="op">(</span><span class="st">"seq_blues"</span><span class="op">)</span>, <span class="st">"sequential"</span><span class="op">)</span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="fu">infer_palette_type</span><span class="op">(</span><span class="st">"div_fireice"</span><span class="op">)</span>, <span class="st">"diverging"</span><span class="op">)</span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="fu">infer_palette_type</span><span class="op">(</span><span class="st">"qual_vivid"</span><span class="op">)</span>, <span class="st">"qualitative"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_error</span><span class="op">(</span><span class="fu">infer_palette_type</span><span class="op">(</span><span class="st">"invalid_name"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"reverse parameter works"</span>, <span class="op">{</span></span>
<span>  <span class="va">colors_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="st">"qual_vivid"</span>, type <span class="op">=</span> <span class="st">"qualitative"</span><span class="op">)</span></span>
<span>  <span class="va">colors_reversed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">colors_normal</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="reference/scale_evanverse.html">scale_color_evanverse</a></span><span class="op">(</span><span class="st">"qual_vivid"</span>, reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">scale_colors</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">$</span><span class="va">scales</span><span class="op">$</span><span class="va">scales</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">palette</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="va">scale_colors</span>, <span class="va">colors_reversed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"interpolate_palette generates correct number of colors"</span>, <span class="op">{</span></span>
<span>  <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu">interpolate_palette</span><span class="op">(</span><span class="st">"seq_blues"</span>, type <span class="op">=</span> <span class="st">"sequential"</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_length</span><span class="op">(</span><span class="va">colors</span>, <span class="fl">20</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^#[0-9A-F]{6}$"</span>, <span class="va">colors</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"theme_evanverse creates valid theme"</span>, <span class="op">{</span></span>
<span>  <span class="va">theme</span> <span class="op">&lt;-</span> <span class="fu">theme_evanverse</span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"light"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_s3_class</span><span class="op">(</span><span class="va">theme</span>, <span class="st">"theme"</span><span class="op">)</span></span>
<span>  <span class="fu">expect_s3_class</span><span class="op">(</span><span class="va">theme</span>, <span class="st">"gg"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"preview_palette_ggplot returns ggplot object"</span>, <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">preview_palette_ggplot</span><span class="op">(</span><span class="st">"qual_vivid"</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">expect_s3_class</span><span class="op">(</span><span class="va">p</span>, <span class="st">"ggplot"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="视觉测试">视觉测试<a class="anchor" aria-label="anchor" href="#%E8%A7%86%E8%A7%89%E6%B5%8B%E8%AF%95"></a></h3>
<p><strong>文件</strong>: <code>tests/visual_tests/test_ggplot2_integration.R</code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/evanbio/evanverse" class="external-link">evanverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 创建测试图表目录</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"tests/visual_tests/output"</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test 1: Qualitative discrete</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/scale_evanverse.html">scale_color_evanverse</a></span><span class="op">(</span><span class="st">"qual_vivid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Test 1: Qualitative Discrete Color"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"tests/visual_tests/output/01_qual_discrete.png"</span>, <span class="va">p1</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test 2: Sequential continuous</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">value</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">y</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_gradient_evanverse</span><span class="op">(</span><span class="st">"seq_blues"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Test 2: Sequential Continuous Fill"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"tests/visual_tests/output/02_seq_continuous.png"</span>, <span class="va">p2</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test 3: Diverging gradient</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">centered</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">value</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">centered</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_gradient2_evanverse</span><span class="op">(</span><span class="st">"div_fireice"</span>, midpoint <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"dark"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Test 3: Diverging Gradient Fill"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"tests/visual_tests/output/03_div_gradient.png"</span>, <span class="va">p3</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test 4: Theme variants</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/scale_evanverse.html">scale_color_evanverse</a></span><span class="op">(</span><span class="st">"qual_vibrant"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_evanverse</span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"minimal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Test 4: Theme Variant - Minimal"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"tests/visual_tests/output/04_theme_minimal.png"</span>, <span class="va">p4</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Visual tests completed. Check tests/visual_tests/output/\n"</span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="发布路线图">发布路线图<a class="anchor" aria-label="anchor" href="#%E5%8F%91%E5%B8%83%E8%B7%AF%E7%BA%BF%E5%9B%BE"></a></h2>
<div class="section level3">
<h3 id="phase-1-基础集成-week-1-2">Phase 1: 基础集成 (Week 1-2)<a class="anchor" aria-label="anchor" href="#phase-1-%E5%9F%BA%E7%A1%80%E9%9B%86%E6%88%90-week-1-2"></a></h3>
<p><strong>目标</strong>: 核心离散和连续scale函数</p>
<p><strong>交付物</strong>: - ✅ <code>scale_color/fill_evanverse()</code> - ✅ <code>scale_*_gradient_evanverse()</code> 系列 - ✅ <code>infer_palette_type()</code> - ✅ <code>interpolate_palette()</code> - ✅ 完整单元测试 - ✅ 使用示例文档</p>
<p><strong>里程碑</strong>: 用户可以在ggplot2中直接使用evanverse色板</p>
<hr></div>
<div class="section level3">
<h3 id="phase-2-主题和工具-week-3">Phase 2: 主题和工具 (Week 3)<a class="anchor" aria-label="anchor" href="#phase-2-%E4%B8%BB%E9%A2%98%E5%92%8C%E5%B7%A5%E5%85%B7-week-3"></a></h3>
<p><strong>目标</strong>: 完整主题系统和辅助工具</p>
<p><strong>交付物</strong>: - ✅ <code>theme_evanverse()</code> 及变体 - ✅ <code>preview_palette_ggplot()</code> - ✅ <code>apply_evanverse_theme()</code> - ✅ 视觉回归测试 - ✅ Vignette: “ggplot2 Integration Guide”</p>
<p><strong>里程碑</strong>: 完整的ggplot2生态系统集成</p>
<hr></div>
<div class="section level3">
<h3 id="phase-3-高级功能-week-4">Phase 3: 高级功能 (Week 4+)<a class="anchor" aria-label="anchor" href="#phase-3-%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD-week-4"></a></h3>
<p><strong>目标</strong>: 增强功能和优化</p>
<p><strong>交付物</strong>: - ✅ 色盲模拟和验证 - ✅ 自动推荐系统 - ✅ 批量导出工具 - ✅ Shiny 交互选择器 - ✅ 性能优化和缓存</p>
<p><strong>里程碑</strong>: 行业领先的色板管理系统</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="依赖项">依赖项<a class="anchor" aria-label="anchor" href="#%E4%BE%9D%E8%B5%96%E9%A1%B9"></a></h2>
<div class="section level3">
<h3 id="必需依赖">必需依赖<a class="anchor" aria-label="anchor" href="#%E5%BF%85%E9%9C%80%E4%BE%9D%E8%B5%96"></a></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>Imports<span class="sc">:</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">ggplot2</span> (<span class="sc">&gt;=</span> <span class="dv">3</span>.<span class="fl">4.0</span>),</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="fu">cli</span> (<span class="sc">&gt;=</span> <span class="dv">3</span>.<span class="fl">6.0</span>),</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  grDevices</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="建议依赖">建议依赖<a class="anchor" aria-label="anchor" href="#%E5%BB%BA%E8%AE%AE%E4%BE%9D%E8%B5%96"></a></h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>Suggests<span class="sc">:</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  colorspace,    <span class="co"># 色盲模拟</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  viridis,       <span class="co"># 参考实现</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  patchwork,     <span class="co"># 示例中的组合图</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  <span class="fu">testthat</span> (<span class="sc">&gt;=</span> <span class="dv">3</span>.<span class="fl">0.0</span>)</span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="文档结构">文档结构<a class="anchor" aria-label="anchor" href="#%E6%96%87%E6%A1%A3%E7%BB%93%E6%9E%84"></a></h2>
<div class="section level3">
<h3 id="vignette-ggplot2-integration-guide">Vignette: “ggplot2 Integration Guide”<a class="anchor" aria-label="anchor" href="#vignette-ggplot2-integration-guide"></a></h3>
<p><strong>文件</strong>: <code>vignettes/ggplot2-integration.Rmd</code></p>
<p><strong>目录</strong>: 1. Introduction 2. Quick Start 3. Discrete Scales - Color scales - Fill scales - Customization options 4. Continuous Scales - Gradients - Diverging gradients - Multi-color gradients 5. Themes - Theme variants - Customization 6. Advanced Usage - Interpolation - Color combinations - Patchwork integration 7. Best Practices 8. Troubleshooting</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="向后兼容性">向后兼容性<a class="anchor" aria-label="anchor" href="#%E5%90%91%E5%90%8E%E5%85%BC%E5%AE%B9%E6%80%A7"></a></h2>
<div class="section level3">
<h3 id="兼容策略">兼容策略<a class="anchor" aria-label="anchor" href="#%E5%85%BC%E5%AE%B9%E7%AD%96%E7%95%A5"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>现有函数不变</strong> - <code><a href="reference/get_palette.html">get_palette()</a></code> 等核心函数保持原有API</li>
<li>
<strong>新增函数独立</strong> - ggplot2集成作为新模块，不修改现有代码</li>
<li>
<strong>渐进式增强</strong> - 用户可选择使用新API或继续使用旧方式</li>
</ol></div>
<div class="section level3">
<h3 id="迁移指南">迁移指南<a class="anchor" aria-label="anchor" href="#%E8%BF%81%E7%A7%BB%E6%8C%87%E5%8D%97"></a></h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 旧方式（仍然支持）</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="st">"qual_vivid"</span>, type <span class="op">=</span> <span class="st">"qualitative"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">colors</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 新方式（推荐）</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/scale_evanverse.html">scale_color_evanverse</a></span><span class="op">(</span><span class="st">"qual_vivid"</span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="性能考虑">性能考虑<a class="anchor" aria-label="anchor" href="#%E6%80%A7%E8%83%BD%E8%80%83%E8%99%91"></a></h2>
<div class="section level3">
<h3 id="优化点">优化点<a class="anchor" aria-label="anchor" href="#%E4%BC%98%E5%8C%96%E7%82%B9"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>懒加载</strong> - scale函数只在渲染时加载色板</li>
<li>
<strong>缓存机制</strong> - 频繁使用的色板缓存到内存</li>
<li>
<strong>最小依赖</strong> - 仅依赖ggplot2核心功能</li>
</ol></div>
<div class="section level3">
<h3 id="性能基准">性能基准<a class="anchor" aria-label="anchor" href="#%E6%80%A7%E8%83%BD%E5%9F%BA%E5%87%86"></a></h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 目标性能</span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu">mark</span><span class="op">(</span></span>
<span>  old <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="reference/get_palette.html">get_palette</a></span><span class="op">(</span><span class="st">"qual_vivid"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  new <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/scale_evanverse.html">scale_color_evanverse</a></span><span class="op">(</span><span class="st">"qual_vivid"</span><span class="op">)</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 预期: 新方式性能损失 &lt; 5%</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="总结">总结<a class="anchor" aria-label="anchor" href="#%E6%80%BB%E7%BB%93"></a></h2>
<div class="section level3">
<h3 id="核心优势">核心优势<a class="anchor" aria-label="anchor" href="#%E6%A0%B8%E5%BF%83%E4%BC%98%E5%8A%BF"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>用户友好</strong> - 一行代码完成配色</li>
<li>
<strong>类型安全</strong> - 自动推断和验证</li>
<li>
<strong>完全兼容</strong> - 所有ggplot2参数透传</li>
<li>
<strong>易于扩展</strong> - 模块化设计便于添加新功能</li>
</ol></div>
<div class="section level3">
<h3 id="实现优先级">实现优先级<a class="anchor" aria-label="anchor" href="#%E5%AE%9E%E7%8E%B0%E4%BC%98%E5%85%88%E7%BA%A7"></a></h3>
<table class="table"><thead><tr><th>功能</th>
<th>优先级</th>
<th>工作量</th>
<th>价值</th>
</tr></thead><tbody><tr><td>离散scale</td>
<td>🔴 高</td>
<td>2天</td>
<td>⭐⭐⭐⭐⭐</td>
</tr><tr><td>连续scale</td>
<td>🔴 高</td>
<td>2天</td>
<td>⭐⭐⭐⭐</td>
</tr><tr><td>主题系统</td>
<td>🟡 中</td>
<td>2天</td>
<td>⭐⭐⭐</td>
</tr><tr><td>辅助工具</td>
<td>🟡 中</td>
<td>1天</td>
<td>⭐⭐⭐</td>
</tr><tr><td>色盲验证</td>
<td>🟢 低</td>
<td>3天</td>
<td>⭐⭐</td>
</tr><tr><td>Shiny选择器</td>
<td>🟢 低</td>
<td>5天</td>
<td>⭐⭐</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="下一步行动">下一步行动<a class="anchor" aria-label="anchor" href="#%E4%B8%8B%E4%B8%80%E6%AD%A5%E8%A1%8C%E5%8A%A8"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>Review设计</strong> - 团队审查本设计文档</li>
<li>
<strong>实现Phase 1</strong> - 开发离散和连续scale函数</li>
<li>
<strong>编写测试</strong> - 单元测试和视觉测试</li>
<li>
<strong>更新文档</strong> - Vignette和函数文档</li>
<li>
<strong>发布v1.5</strong> - 包含ggplot2集成的版本</li>
</ol><hr><p><strong>设计者</strong>: AI Assistant <strong>审核状态</strong>: 待审核 <strong>预计完成</strong>: Phase 1-2 约2-3周</p>
<hr><p><em>本设计文档基于现有evanverse色板系统架构，遵循ggplot2生态系统的最佳实践。</em></p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/evanbio" class="external-link"><img src="https://github.com/evanbio.png" height="32" style="border-radius: 50%;"> Evan Zhou</a>. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.
</p>
<div class="text-muted">
<p><i class="fas fa-balance-scale me-1"></i> <a href="https://opensource.org/licenses/MIT" class="external-link text-muted">MIT License</a></p>
</div>
</div>

<div class="pkgdown-footer-right">
  <div class="text-muted">
<p><strong>evanverse v0.3.7</strong><br><small>Last updated: October 2025</small></p>
</div><div class="footer-links">
<p><a href="https://github.com/evanbio/evanverse" class="external-link text-muted me-3" aria-label="GitHub"> <i class="fab fa-github fa-lg"></i> </a> <a href="https://cran.r-project.org/package=evanverse" class="external-link text-muted me-3" aria-label="CRAN"> <i class="fas fa-download fa-lg"></i> </a> <a href="https://blog.evanzhou.org" class="external-link text-muted" aria-label="Blog"> <i class="fas fa-blog fa-lg"></i> </a></p>
</div>
</div>

    </footer></div>





  </body></html>

